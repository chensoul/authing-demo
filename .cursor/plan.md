# 项目背景

本项目旨在实现一个类似 Auth0/Authing 的身份认证与授权系统，支持多租户、用户管理、权限控制、第三方登录、应用集成、计费等功能。后端采用 Spring Boot，前端采用 Vue，目标是打造一套可自部署、可扩展的身份服务平台。

# 需求说明

- 支持多租户与用户池体系：
  - 用户池（User Pool）是核心隔离单元，所有用户、应用、权限等均归属于某个用户池。
  - 用户池表（user_pool）包含 tenant_id 字段，支持一个租户拥有多个用户池。
  - 用户池类型（type）支持 B2C、B2B、B2E，不同类型下用户池与租户的关系如下：
    - B2C：面向外部用户，用户池不归属于具体租户（tenant_id 为空），适用于 App 注册用户、网站会员等。B2C 用户池下的应用、用户、角色、权限等均通过 user_pool_id 关联，支持社交认证源（如微信、GitHub、Google 等），应用和用户可直接配置权限，也可通过角色或用户组分配权限。
    - B2E：单租户员工模式，面向企业内部员工账号体系，用户池不归属于具体租户（tenant_id 为空），即平台级或单企业专用。B2E 用户池下的应用、用户、角色、资源等均通过 user_pool_id 关联，支持用户组、部门、机构、岗位等多维组织关系，支持企业认证源（如 LDAP、企业微信、钉钉、AD 等），应用和用户可直接配置权限，也可通过角色、用户组、岗位等分配权限。
    - B2B：多租户自运营模式，面向企业客户（租户），每个租户拥有独立的用户池和账号体系。平台支持多个租户，每个租户可自主管理自己的用户池、应用、组织结构、权限等。B2B 用户池（type = 'B2B'）归属于租户（tenant_id 必填），应用、用户、角色、资源等均通过 user_pool_id 关联，支持用户组、部门、机构、岗位等多维组织关系。每个租户可配置自己的企业认证源（如 LDAP、AD、企业微信、钉钉等），支持用户同步。应用和租户之间可配置权限，用户/角色/组织等也可通过 user_pool_id 进行权限隔离和分配。
    - B2B 代运营模式：平台方为企业客户（租户）统一创建和管理用户池、应用、认证源、权限等，企业客户只拥有业务操作权限，不具备账号体系管理权限。所有配置和运营由平台方负责，适合 SaaS 平台、ISV、渠道商等为下游企业客户提供一站式身份服务。各企业客户的用户池、应用、组织结构、权限体系均独立隔离，认证源由平台方统一接入和维护。
    - B2B 混合运营模式：平台方与企业客户（租户）可灵活协作，共同管理用户池、应用、认证源、权限等。租户可自主管理部分资源，也可委托平台方托管部分或全部资源。认证源、权限分配等可由租户或平台方管理，适合有一定 IT 能力的企业客户，支持运营模式灵活切换，满足不同业务线、发展阶段的需求。
- 用户注册、登录、找回密码、邮箱/手机验证
- 支持第三方社交登录（如微信、GitHub、Google 等）
- 用户信息管理（资料、密码、绑定第三方账号等）
- 角色与权限管理（RBAC）
- 应用管理（每个租户可创建多个应用，配置回调、密钥等）
- API 授权（OAuth2/OpenID Connect 支持）
- 审计日志（登录、操作、异常等）
- 计费与套餐管理（按 MAU、API 调用量等）
- 管理后台（Vue 实现，支持租户、用户、权限、应用等可视化管理）
- 开发者文档与集成 SDK（后续可扩展）

# 高层任务拆分

1. 技术选型与项目初始化
   - Spring Boot 后端项目搭建
   - Vue 前端项目搭建
   - 基础数据库设计（多租户、用户、应用、权限等核心表）
   - 成功标准：项目可启动，数据库结构初步成型

2. 用户与租户体系搭建
   - 用户注册、登录、找回密码、邮箱/手机验证
   - 多租户隔离（用户池、应用、权限等）
   - 成功标准：可注册/登录用户，租户间数据隔离

3. 角色与权限（RBAC）
   - 角色、权限模型设计与实现
   - 用户-角色-权限分配
   - 成功标准：可为用户分配角色，角色赋权，权限校验生效

4. 应用与 API 授权
   - 应用注册、配置回调、密钥管理
   - OAuth2/OpenID Connect 基础实现
   - 成功标准：第三方应用可集成登录，获取用户信息

5. 第三方社交登录
   - 集成主流社交平台（如微信、GitHub、Google）
   - 成功标准：可通过社交账号注册/登录

6. 管理后台（Vue）
   - 租户、用户、角色、权限、应用等管理界面
   - 成功标准：管理员可通过前端管理各核心资源

7. 计费与套餐管理
   - MAU、API 调用量等计费模型
   - 套餐配置、订单、支付集成（可选）
   - 成功标准：可配置套餐，统计用量，生成订单

8. 审计日志与安全
   - 登录、操作、异常等日志记录
   - 安全加固（如密码加密、接口防护等）
   - 成功标准：关键操作有日志，安全机制生效

9. 开发者文档与 SDK（后续）
   - API 文档、集成指南
   - SDK 封装（可选）
   - 成功标准：开发者可快速集成

# 项目状态看板

- [ ] 1. 技术选型与项目初始化
- [ ] 2. 用户与租户体系搭建
- [ ] 3. 角色与权限（RBAC）
- [ ] 4. 应用与 API 授权
- [ ] 5. 第三方社交登录
- [ ] 6. 管理后台（Vue）
- [ ] 7. 计费与套餐管理
- [ ] 8. 审计日志与安全
- [ ] 9. 开发者文档与 SDK

# 执行者反馈或请求帮助

（待执行者填写）

# 经验教训

- 编辑文件前先读文件。
- 程序输出要包含调试信息。
- 用 -force git 命令前要先问。
